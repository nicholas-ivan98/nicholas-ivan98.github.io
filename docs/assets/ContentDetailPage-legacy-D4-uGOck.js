System.register(["./index-legacy-DweIJQBn.js","./Crypto-legacy-CxS5-HWR.js","./ChaptersView-legacy-BdQ4U7Un.js"],(function(t,e){"use strict";var a,n,l,i,o,r,u,s,c,d,v,p,h,f,g,m,b,y,x,k,_,C,w,j,D,T,V,A,U,E,F,I,O,S,$,L,q,H,N,R,z,J,M,G,B,P,W;return{setters:[t=>{a=t.e,n=t.f,l=t.g,i=t.m,o=t.u,r=t.a3,u=t.l,s=t.C,c=t.D,d=t.$,v=t.a0,p=t.a1,h=t._,f=t.r,g=t.q,m=t.s,b=t.a5,y=t.d,x=t.a,k=t.x,_=t.ah,C=t.ak,w=t.b,j=t.v,D=t.k,T=t.W,V=t.X,A=t.Y,U=t.y,E=t.z,F=t.G,I=t.ae,O=t.af,S=t.M,$=t.al,L=t.E,q=t.am,H=t.an,N=t.J,R=t.ai,z=t.j,J=t.F,M=t.T,G=t.U,B=t.aj},t=>{P=t.C},t=>{W=t.C}],execute:function(){var e=document.createElement("style");e.textContent="h4[data-v-ab94a8ed]{margin:18px 8px}ion-label[data-v-ab94a8ed]{margin-left:8px;margin-right:8px;display:flex;margin-top:8px}h4.title-content[data-v-607122b8]{display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;text-align:center;margin-left:32px;margin-right:32px}.thumbnail-container[data-v-607122b8]{display:flex;justify-content:center;margin-top:32px;margin-bottom:18px}ion-img.thumbnail-content[data-v-607122b8]{width:150px;height:214px}.segment-container[data-v-607122b8]{margin:18px}.reading-button-container[data-v-607122b8]{margin:18px;display:flex;justify-content:center;align-items:center}ion-button[data-v-607122b8]{height:50px;text-transform:none;font-size:medium;margin:4px;color:#fff}ion-icon.icon-favorite[data-v-607122b8]{width:24px;height:24px;margin-right:12px}\n",document.head.appendChild(e);const X=t=>(d("data-v-ab94a8ed"),t=t(),v(),t),Y=X((()=>p("h4",null,"Info",-1))),K=X((()=>p("h4",null,"Description",-1))),Q=h(a({__name:"DetailView",props:{content:{type:Object,required:!0,default:null}},setup(t){const e=t;function a(){var t,a,n,l,i,o;let r="";return null!==(t=e.content)&&void 0!==t&&t.alternative&&(r+=e.content.alternative),null!==(a=e.content)&&void 0!==a&&a.author&&(r+=`<br><br> Author: ${e.content.author}`),null!==(n=e.content)&&void 0!==n&&n.genres&&(r+=`<br><br> Genres: ${e.content.genres}`),null!==(l=e.content)&&void 0!==l&&l.status&&(r+=`<br><br> Status: ${e.content.status}`),null!==(i=e.content)&&void 0!==i&&i.view&&(r+=`<br><br> View: ${e.content.view}`),null!==(o=e.content)&&void 0!==o&&o.lastUpdate&&(r+=`<br><br> Last update: ${e.content.lastUpdate}`),r}return(t,d)=>(n(),l("div",null,[Y,i(o(r),{innerHTML:a()},null,8,["innerHTML"]),K,i(o(r),null,{default:u((()=>{var t;return[s(c(null===(t=e.content)||void 0===t?void 0:t.description),1)]})),_:1})]))}}),[["__scopeId","data-v-ab94a8ed"]]),Z={class:"thumbnail-container"},tt={class:"title-content"},et={class:"reading-button-container"},at=["textContent"],nt={class:"segment-container"};t("default",h(a({__name:"ContentDetailPage",setup(t){const e=f(),a=f(!1),d=f("Chapters"),v=g(),h=m(),X=b(),Y=["Chapters","Detail"],K=y((()=>v.getters["account/getAccount"])),lt=y((()=>{var t,a,n;return v.getters["favorites/getFavorite"](null===(t=e.value)||void 0===t?void 0:t.title,null===(a=e.value)||void 0===a?void 0:a.url,null===(n=e.value)||void 0===n?void 0:n.thumbnail)})),it=y((()=>{var t;return v.getters["histories/getHistory"](null===(t=e.value)||void 0===t?void 0:t.url)}));async function ot(t){try{const a=await T.post(V.CONTENT_DETAIL,{url:t},{headers:{app:A}});!function(t){const a=e.value;a&&(a.alternative=t.alternative,a.author=t.author,a.description=t.description,a.lastUpdate=t.lastUpdate,a.status=t.status,a.view=t.view,a.chapters=t.chapters,a.genres=t.genres.map((t=>t.name)).join(", "),e.value=a)}(a.data.data)}catch(a){console.log("Content detail error: ",a)}}function rt(){if(e.value){0===e.value.currentChapter&&(e.value.currentChapter=1),v.dispatch("histories/setHistory",e.value);const t=P.encrypt(JSON.stringify(e.value));X.push({path:"/reading",query:{content:t}})}}function ut(){a.value?async function(){const t=K.value.apikey;try{const e=(await T.delete(V.FAVORITES,{headers:{apikey:t},data:{ids:[lt.value._id]}})).data;v.dispatch("favorites/setFavorites",e.data),a.value=!1}catch(e){console.log("Remove favorite failed",e)}}():async function(){const t=K.value.apikey;try{var n,l,i;const o=(await T.post(V.FAVORITES,{url:null===(n=e.value)||void 0===n?void 0:n.url,title:null===(l=e.value)||void 0===l?void 0:l.title,thumbnail:null===(i=e.value)||void 0===i?void 0:i.thumbnail},{headers:{apikey:t}})).data;v.dispatch("favorites/setFavorites",o.data),a.value=!0,console.log("Add favorite success",o)}catch(o){console.log("Add favorite success",o)}}()}return x((()=>{e.value=JSON.parse(P.decrypt(h.query.content)),e.value&&(lt.value&&(a.value=!0),it.value&&(e.value.currentChapter=it.value.currentChapter),ot(e.value.url))})),k((()=>{})),_((()=>{})),C((()=>{})),w((()=>{})),j((()=>{})),(t,v)=>(n(),D(o(G),null,{default:u((()=>[i(o(S),{translucent:!0},{default:u((()=>[i(o(U),null,{default:u((()=>[i(o(E),{slot:"start",onClick:v[0]||(v[0]=()=>o(X).back())},{default:u((()=>[i(o(F),{ios:o(I),md:o(O),style:{width:"24px",height:"24px","margin-left":"4px"},color:"primary"},null,8,["ios","md"]),i(o(r),{style:{"margin-left":"4px","font-size":"medium"},color:"primary"},{default:u((()=>[s("Back")])),_:1})])),_:1})])),_:1})])),_:1}),i(o(M),{fullscreen:!0},{default:u((()=>{var t,h;return[p("div",Z,[i(o($),{class:"thumbnail-content",src:null===(t=e.value)||void 0===t?void 0:t.thumbnail},null,8,["src"])]),p("h4",tt,c(null===(h=e.value)||void 0===h?void 0:h.title),1),p("div",et,[K.value.apikey?(n(),D(o(L),{key:0,shape:"round",color:a.value?"danger":"success",onClick:ut},{default:u((()=>[a.value?(n(),D(o(F),{key:0,icon:o(q),slot:"start"},null,8,["icon"])):(n(),D(o(F),{key:1,icon:o(H),slot:"start"},null,8,["icon"])),p("span",{textContent:c(a.value?"Unlike":"Like")},null,8,at)])),_:1},8,["color"])):N("",!0),i(o(L),{shape:"round",onClick:rt},{default:u((()=>[s("Reading")])),_:1})]),p("div",nt,[i(o(R),{value:"Detail",class:"segment-content",modelValue:d.value,"onUpdate:modelValue":v[1]||(v[1]=t=>d.value=t)},{default:u((()=>[(n(),l(J,null,z(Y,(t=>i(o(B),{key:t,value:t},{default:u((()=>[i(o(r),null,{default:u((()=>[s(c(t),1)])),_:2},1024)])),_:2},1032,["value"]))),64))])),_:1},8,["modelValue"]),"Detail"===d.value?(n(),D(Q,{key:0,content:e.value},null,8,["content"])):"Chapters"===d.value?(n(),D(W,{key:1,content:e.value},null,8,["content"])):N("",!0)])]})),_:1})])),_:1}))}}),[["__scopeId","data-v-607122b8"]]))}}}));
