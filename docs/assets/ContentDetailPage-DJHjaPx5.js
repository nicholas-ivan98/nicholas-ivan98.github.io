import{e as $,f as d,g as E,m as r,u as n,a3 as k,l,C as I,D as b,$ as J,a0 as P,a1 as v,_ as N,r as w,q as W,s as z,a5 as G,d as V,a as X,x as Y,ah as K,ak as Q,b as Z,v as ee,k as m,W as D,X as x,Y as te,y as ae,z as ne,G as S,ae as oe,af as se,M as re,al as le,E as T,am as ie,an as ue,J as L,ai as ce,j as de,F as pe,T as ve,U as fe,aj as he}from"./index-DvlJoje3.js";import{C as U}from"./Crypto-BxROEsW-.js";import{C as me}from"./ChaptersView-BByN0bcz.js";const A=f=>(J("data-v-ab94a8ed"),f=f(),P(),f),_e=A(()=>v("h4",null,"Info",-1)),ge=A(()=>v("h4",null,"Description",-1)),ye=$({__name:"DetailView",props:{content:{type:Object,required:!0,default:null}},setup(f){const e=f;function u(){var i,p,_,C,h,g;let s="";return(i=e.content)!=null&&i.alternative&&(s+=e.content.alternative),(p=e.content)!=null&&p.author&&(s+="<br><br> Author: ".concat(e.content.author)),(_=e.content)!=null&&_.genres&&(s+="<br><br> Genres: ".concat(e.content.genres)),(C=e.content)!=null&&C.status&&(s+="<br><br> Status: ".concat(e.content.status)),(h=e.content)!=null&&h.view&&(s+="<br><br> View: ".concat(e.content.view)),(g=e.content)!=null&&g.lastUpdate&&(s+="<br><br> Last update: ".concat(e.content.lastUpdate)),s}return(s,i)=>(d(),E("div",null,[_e,r(n(k),{innerHTML:u()},null,8,["innerHTML"]),ge,r(n(k),null,{default:l(()=>{var p;return[I(b((p=e.content)==null?void 0:p.description),1)]}),_:1})]))}}),Ce=N(ye,[["__scopeId","data-v-ab94a8ed"]]),Ie={class:"thumbnail-container"},be={class:"title-content"},ke={class:"reading-button-container"},we=["textContent"],Ve={class:"segment-container"},De=$({__name:"ContentDetailPage",setup(f){const e=w(),u=w(!1),s=w("Chapters"),i=W(),p=z(),_=G(),C=["Chapters","Detail"],h=V(()=>i.getters["account/getAccount"]),g=V(()=>{var a,t,o;return i.getters["favorites/getFavorite"]((a=e.value)==null?void 0:a.title,(t=e.value)==null?void 0:t.url,(o=e.value)==null?void 0:o.thumbnail)}),B=V(()=>{var a;return i.getters["histories/getHistory"]((a=e.value)==null?void 0:a.url)});function R(a){const t=e.value;t&&(t.alternative=a.alternative,t.author=a.author,t.description=a.description,t.lastUpdate=a.lastUpdate,t.status=a.status,t.view=a.view,t.chapters=a.chapters,t.genres=a.genres.map(o=>o.name).join(", "),e.value=t)}async function O(a){try{const o=(await D.post(x.CONTENT_DETAIL,{url:a},{headers:{app:te}})).data;R(o.data)}catch(t){console.log("Content detail error: ",t)}}function H(){if(e.value){e.value.currentChapter===0&&(e.value.currentChapter=1),i.dispatch("histories/setHistory",e.value);const a=U.encrypt(JSON.stringify(e.value));_.push({path:"/reading",query:{content:a}})}}function j(){u.value?M():q()}async function q(){var t,o,y;const a=h.value.apikey;try{const F=(await D.post(x.FAVORITES,{url:(t=e.value)==null?void 0:t.url,title:(o=e.value)==null?void 0:o.title,thumbnail:(y=e.value)==null?void 0:y.thumbnail},{headers:{apikey:a}})).data;i.dispatch("favorites/setFavorites",F.data),u.value=!0,console.log("Add favorite success",F)}catch(c){console.log("Add favorite success",c)}}async function M(){const a=h.value.apikey;try{const o=(await D.delete(x.FAVORITES,{headers:{apikey:a},data:{ids:[g.value._id]}})).data;i.dispatch("favorites/setFavorites",o.data),u.value=!1}catch(t){console.log("Remove favorite failed",t)}}return X(()=>{e.value=JSON.parse(U.decrypt(p.query.content)),e.value&&(g.value&&(u.value=!0),B.value&&(e.value.currentChapter=B.value.currentChapter),O(e.value.url))}),Y(()=>{}),K(()=>{}),Q(()=>{}),Z(()=>{}),ee(()=>{}),(a,t)=>(d(),m(n(fe),null,{default:l(()=>[r(n(re),{translucent:!0},{default:l(()=>[r(n(ae),null,{default:l(()=>[r(n(ne),{slot:"start",onClick:t[0]||(t[0]=()=>n(_).back())},{default:l(()=>[r(n(S),{ios:n(oe),md:n(se),style:{width:"24px",height:"24px","margin-left":"4px"},color:"primary"},null,8,["ios","md"]),r(n(k),{style:{"margin-left":"4px","font-size":"medium"},color:"primary"},{default:l(()=>[I("Back")]),_:1})]),_:1})]),_:1})]),_:1}),r(n(ve),{fullscreen:!0},{default:l(()=>{var o,y;return[v("div",Ie,[r(n(le),{class:"thumbnail-content",src:(o=e.value)==null?void 0:o.thumbnail},null,8,["src"])]),v("h4",be,b((y=e.value)==null?void 0:y.title),1),v("div",ke,[h.value.apikey?(d(),m(n(T),{key:0,shape:"round",color:u.value?"danger":"success",onClick:j},{default:l(()=>[u.value?(d(),m(n(S),{key:0,icon:n(ie),slot:"start"},null,8,["icon"])):(d(),m(n(S),{key:1,icon:n(ue),slot:"start"},null,8,["icon"])),v("span",{textContent:b(u.value?"Unlike":"Like")},null,8,we)]),_:1},8,["color"])):L("",!0),r(n(T),{shape:"round",onClick:H},{default:l(()=>[I("Reading")]),_:1})]),v("div",Ve,[r(n(ce),{value:"Detail",class:"segment-content",modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=c=>s.value=c)},{default:l(()=>[(d(),E(pe,null,de(C,c=>r(n(he),{key:c,value:c},{default:l(()=>[r(n(k),null,{default:l(()=>[I(b(c),1)]),_:2},1024)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),s.value==="Detail"?(d(),m(Ce,{key:0,content:e.value},null,8,["content"])):s.value==="Chapters"?(d(),m(me,{key:1,content:e.value},null,8,["content"])):L("",!0)])]}),_:1})]),_:1}))}}),Fe=N(De,[["__scopeId","data-v-607122b8"]]);export{Fe as default};
